@model IEnumerable<EmployeeManagementSystem.Models.ApplicationUser>

@{
        ViewBag.Title = "Users";
    }
<head>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

    <link href="https://cdn.datatables.net/1.10.15/css/dataTables.bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.datatables.net/responsive/2.1.1/css/responsive.bootstrap.min.css" rel="stylesheet" />

    <script src="https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.15/js/dataTables.bootstrap4.min.js "></script>
    <script>
        $(document).ready(function () {
            //start of the document ready function
            //delcaring global variable to hold primary key value.
            var pryEmpId;
            $('.delete-prompt').click(function () {
                pryEmpId = $(this).attr('id');
                $('#myModal').modal('show');
            });

            $('.delete-confirm').click(function () {
                if (pryEmpId != '') {
                    $.ajax({
                        url: '/User/DeleteConfirm/' + pryEmpId,
                        //data: { 'id': pryEmpId },
                        type: 'get',
                        success: function (data) {
                            debugger
                            if (data) {
                                toastify("error", 'Record deleted successfully');
                                document.location.reload() 
                            }
                            $('#myModal').modal('hide');
                        }, error: function (err) {
                            debugger
                            toastify("error", err.statusText);
                        }
                    });
                }
            });

            //function to reset bootstrap modal popups
            //$("#myModal").on("hidden.bs.modal", function () {
            //    $(".modal-header").removeClass(' ').addClass('alert-danger');
            //    $('.delete-confirm').css('display', 'inline-block');
            //    $('.success-message').html('').html('Are you sure you wish to delete this record ?');
            //});

            //end of the docuement ready function
        });
    </script>
</head>
@*<h2>Index</h2>*@

<p>
    <a class="btn btn-success glyphicon glyphicon-plus" href="@Url.Action("Create","User")"></a>

</p>
<table id="demoGrid" class="table table-striped table-bordered dt-responsive nowrap" width="100%" cellspacing="0">
    <thead>
        <tr>
            <th style="text-align:center">
                @Html.DisplayNameFor(model => model.Email)
            </th>

            <th style="text-align:center">
                @Html.DisplayNameFor(model => model.FirstName)
            </th>
            <th style="text-align:center">
                @Html.DisplayNameFor(model => model.LastName)
            </th>
            <th style="text-align:center">Edit</th>
            <th style="text-align:center">Delete</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.Email)
            </td>

            <td>
                @Html.DisplayFor(modelItem => item.FirstName)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.LastName)
            </td>
            <td style="text-align:center">
                <a class="btn btn-info glyphicon glyphicon-edit" href="@Url.Action("Edit","User",new { id = @item.Id})"></a>
            </td>
            <td style="text-align:center">
                <a class="btn btn-danger glyphicon glyphicon-trash delete-prompt" id="@item.Id" data-toggle="modal" data-target="#exampleModalCenter" data-whatever="@item.FirstName"></a>
            </td>
            <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLongTitle">Delete User</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <h3>Are You Sure Want to Delete This User @item.FirstName??</h3>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-danger delete-confirm">Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </tr>
        }
    </tbody>
</table>
<script>




    $('#demoGrid').dataTable({
        "language": {
            "lengthMenu": "Display _MENU_ records per page",
            "zeroRecords": "Nothing found - sorry",
            "info": "Showing page _PAGE_ of _PAGES_",
            "infoEmpty": "No records available",
            "infoFiltered": "(filtered from _MAX_ total records)"
        }
    });
</script>

@*<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Delete User</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <h3>Are You Sure Want to Delete This User??</h3>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-danger">Delete</button>
            </div>
        </div>
    </div>
</div>*@


@*href="@Url.Action("Delete", "User", new { id = @item.Id })"*@